# PrintMaster Server Configuration Example for Docker
# Mount this file to /var/lib/printmaster/server/config.toml

[server]
  # HTTP port (for reverse proxy backend)
  http_port = 9090
  
  # HTTPS port (for direct access or dual-TLS)
  https_port = 9443
  
  # Enable reverse proxy mode (trusts X-Forwarded-For, CF-Connecting-IP, etc.)
  behind_proxy = true
  
  # Set to true if using Cloudflare proxy (automatically trusts Cloudflare IPs)
  # Useful when Cloudflare connects directly to this server
  cloudflare_proxy = false
  
  # Use HTTPS even when behind proxy (dual-TLS setup)
  # Set to false if nginx terminates TLS (most common)
  proxy_use_https = false
  
  # Trusted proxies for client IP header parsing.
  # Can be IP addresses, CIDR ranges, or hostnames (resolved at startup).
  # In Docker Compose, you can use the service name (e.g., "nginx", "traefik").
  # Defaults to private network ranges when behind_proxy=true.
  # trusted_proxies = ["nginx", "172.16.0.0/12"]
  
  # Bind to all interfaces (required for Docker)
  bind_address = "0.0.0.0"

  # Containers rely on orchestrators for upgrades, keep this disabled
  self_update_enabled = false

[security]
  # Enable authentication rate limiting
  rate_limit_enabled = true
  rate_limit_max_attempts = 5
  rate_limit_block_minutes = 5
  rate_limit_window_minutes = 2

[tls]
  # TLS mode: "self-signed", "custom", "letsencrypt"
  mode = "self-signed"
  
  # Domain for self-signed cert
  domain = "localhost"
  
  # Custom certificate paths (when mode = "custom")
  cert_path = ""
  key_path = ""
  
  [tls.letsencrypt]
    # Let's Encrypt settings (when mode = "letsencrypt")
    domain = ""
    email = ""
    cache_dir = "letsencrypt-cache"
    accept_tos = false

[database]
  # Database path (use volume mount)
  path = "/var/lib/printmaster/server/printmaster.db"

[logging]
  # Log level: "debug", "info", "warn", "error"
  level = "info"

[releases]
  # Keep a smaller cache in container deployments
  max_releases = 4
  poll_interval_minutes = 240

[self_update]
  # Containers typically disable self-update, but channel still required
  channel = "stable"
  max_artifacts = 12
  check_interval_minutes = 360
