# PrintMaster Server Configuration Example
# Copy this file to config.toml and customize for your environment

[server]
  # HTTP port for API and web UI
  http_port = 9090
  
  # HTTPS port (if not using reverse proxy)
  https_port = 9443
  
  # Set to true if behind Nginx Proxy Manager, Traefik, etc.
  behind_proxy = false
  
  # Set to true if using Cloudflare proxy (automatically trusts Cloudflare IPs)
  # This also enables behind_proxy behavior
  cloudflare_proxy = false
  
  # Set to true if your reverse proxy handles HTTPS
  proxy_use_https = false
  
  # Trusted proxies for client IP header parsing.
  # Can be IP addresses, CIDR ranges, or hostnames (resolved at startup).
  # Defaults to private network ranges when behind_proxy=true.
  # trusted_proxies = ["nginx", "10.0.0.0/8"]
  
  # Bind address (0.0.0.0 = all interfaces, 127.0.0.1 = localhost only)
  bind_address = "0.0.0.0"

  # Allow the server to download and stage signed updates when supported
  self_update_enabled = true

[security]
  # Enable authentication rate limiting to block brute force attacks
  rate_limit_enabled = true
  
  # Maximum failed authentication attempts before blocking
  rate_limit_max_attempts = 5
  
  # Minutes to block IP+token after max attempts exceeded
  rate_limit_block_minutes = 5
  
  # Time window in minutes for counting failed attempts
  rate_limit_window_minutes = 2

[tls]
  # TLS mode: "disabled", "self-signed", "letsencrypt", "custom"
  mode = "self-signed"
  
  # Domain name for certificate
  domain = "localhost"
  
  # Custom certificate paths (if mode = "custom")
  cert_path = ""
  key_path = ""
  
  [tls.letsencrypt]
    # Domain for Let's Encrypt certificate
    domain = ""
    
    # Email for Let's Encrypt notifications
    email = ""
    
    # Cache directory for Let's Encrypt certificates
    cache_dir = "letsencrypt-cache"
    
    # Accept Let's Encrypt Terms of Service
    accept_tos = false

[database]
  # Database driver: "sqlite" (default), "postgres", or "mysql"
  # driver = "postgres"
  
  # SQLite database file path (only used when driver = "sqlite")
  path = "printmaster.db"
  
  # PostgreSQL/MySQL connection settings (uncomment to use)
  # host = "localhost"
  # port = 5432
  # user = "printmaster"
  # password = "changeme"
  # name = "printmaster"
  # ssl_mode = "prefer"
  
  # TimescaleDB support (PostgreSQL only)
  # When using TimescaleDB, set to true for automatic:
  #   - Hypertables: Auto-partitioned time-series tables for faster queries
  #   - Compression: Up to 95% storage reduction for historical metrics
  #   - Continuous Aggregates: Auto-maintained hourly/daily rollups
  #   - Retention Policies: Automatic old data cleanup
  # If not set, TimescaleDB features are auto-detected.
  # timescale = true

[logging]
  # Log level: debug, info, warn, error
  level = "info"

[tenancy]
  # Enable tenancy (join tokens + Customers UI) by default
  enabled = true

[releases]
  # Number of releases per component cached locally
  max_releases = 6

  # Minutes between automatic release syncs
  poll_interval_minutes = 240

[self_update]
  # Channel to follow when applying server updates
  channel = "stable"

  # Limit of cached artifacts considered for update selection
  max_artifacts = 12

  # Minutes between automatic self-update checks
  check_interval_minutes = 360
